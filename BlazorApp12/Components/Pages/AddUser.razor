@page "/AddUser"
@using ApiContracts
@using BlazorApp12.Services
@rendermode InteractiveServer
@inject HtttpsUserService UserService

<h3>Add User</h3>

@if (errorMessage != null)
{
    <p style="color: red">@errorMessage</p>
}

@if (successMessage != null)
{
    <p style="color: green">@successMessage</p>
}

<EditForm Model="@newUser" OnValidSubmit="HandleValidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />

    
    <div>
        <label for="username">Username:</label>
        <InputText id="username" @bind-Value="newUser.Username" />
    </div>

  

    <button type="submit">Add User</button>
</EditForm>

@code {
    private UserDTO newUser = new UserDTO(0,null);
    private string? errorMessage;
    private string? successMessage;

    private async Task HandleValidSubmit()
    {
        try
        {
            await UserService.AddUserAsync(newUser);
            successMessage = "User added successfully!";
            errorMessage = null;
            newUser = new UserDTO(0,null); // Reset form
        }
        catch (Exception ex)
        {
            errorMessage = $"Error: {ex.Message}";
            successMessage = null;
        }
    }
}